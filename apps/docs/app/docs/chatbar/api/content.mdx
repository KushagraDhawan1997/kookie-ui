import { Table, Text, Code, Box, Callout, Flex, Button, IconButton, Card, Image, Theme, Badge, Section, Separator, Heading } from '@kushagradhawan/kookie-ui';
import { ChevronDown, Dot, Check, ChevronRight, MessageSquare, Paperclip, Send, X } from 'lucide-react';
import { CodeBlock } from '../../../components/code-block';

<Section size="1">

# API

The Chatbar component is a comprehensive multi-line text input designed for chat interfaces with built-in attachment support, auto-resizing behavior, and comprehensive file handling capabilities. It provides controlled and uncontrolled state management, drag-and-drop functionality, and accessibility compliance out of the box.

<CodeBlock buttonsPosition="center">

```tsx
import { Chatbar } from '@kushagradhawan/kookie-ui';
```

</CodeBlock>

</Section>

<Separator size="4"/>

<Section size="1">

## Basic Usage

<CodeBlock>

```tsx
<Chatbar.Root onSubmit={({ value, attachments }) => {
  console.log('Message:', value);
  console.log('Attachments:', attachments);
}}>
  <Chatbar.Textarea 
    placeholder="Type a message..."
    aria-label="Message input"
  />
  <Chatbar.AttachTrigger />
  <Chatbar.Send />
</Chatbar.Root>
```

</CodeBlock>

</Section>

<Separator size="4"/>

<Section size="1">

## Props

<Box>
  <Table.Root mt="6" mb="6" size="2" variant="ghost">
    <Table.Header>
      <Table.Row>
        <Table.ColumnHeaderCell>Prop</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Type</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Default</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Description</Table.ColumnHeaderCell>
      </Table.Row>
    </Table.Header>
    <Table.Body>
      <Table.Row>
        <Table.RowHeaderCell>`value`</Table.RowHeaderCell>
        <Table.Cell>`string`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Controlled value of the text input</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`defaultValue`</Table.RowHeaderCell>
        <Table.Cell>`string`</Table.Cell>
        <Table.Cell>`''`</Table.Cell>
        <Table.Cell>Default value for uncontrolled usage</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`onValueChange`</Table.RowHeaderCell>
        <Table.Cell>`(value: string) => void`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Callback when the value changes</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`open`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Controlled open state for expanded mode</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`defaultOpen`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`false`</Table.Cell>
        <Table.Cell>Default open state for uncontrolled usage</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`onOpenChange`</Table.RowHeaderCell>
        <Table.Cell>`(open: boolean) => void`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Callback when the open state changes</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`expandOn`</Table.RowHeaderCell>
        <Table.Cell>`'none' | 'focus' | 'overflow' | 'both'`</Table.Cell>
        <Table.Cell>`'both'`</Table.Cell>
        <Table.Cell>When to expand the chatbar from compact to full mode</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`minLines`</Table.RowHeaderCell>
        <Table.Cell>`number`</Table.Cell>
        <Table.Cell>`1`</Table.Cell>
        <Table.Cell>Minimum number of lines in compact state</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`maxLines`</Table.RowHeaderCell>
        <Table.Cell>`number`</Table.Cell>
        <Table.Cell>`6`</Table.Cell>
        <Table.Cell>Maximum number of lines before scrolling</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`sendMode`</Table.RowHeaderCell>
        <Table.Cell>`'always' | 'whenDirty' | 'never'`</Table.Cell>
        <Table.Cell>`'whenDirty'`</Table.Cell>
        <Table.Cell>When to show the send button</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`disabled`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Disables the entire chatbar</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`readOnly`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Makes the chatbar read-only</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`onSubmit`</Table.RowHeaderCell>
        <Table.Cell>`(payload: { value: string; attachments: ChatbarAttachment[] }) => void`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Callback when the form is submitted</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`size`</Table.RowHeaderCell>
        <Table.Cell>`'1' | '2' | '3'`</Table.Cell>
        <Table.Cell>`'2'`</Table.Cell>
        <Table.Cell>Size of the chatbar and its components</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`variant`</Table.RowHeaderCell>
        <Table.Cell>`'surface' | 'outline' | 'classic' | 'ghost' | 'soft'`</Table.Cell>
        <Table.Cell>`'surface'`</Table.Cell>
        <Table.Cell>Visual variant of the chatbar container</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`color`</Table.RowHeaderCell>
        <Table.Cell>`string`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Accent color for the control</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`radius`</Table.RowHeaderCell>
        <Table.Cell>`string | number`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Border radius override</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`material`</Table.RowHeaderCell>
        <Table.Cell>`'solid' | 'translucent'`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Panel/material translucency</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`width`</Table.RowHeaderCell>
        <Table.Cell>`React.CSSProperties['width']`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Width of the chatbar container</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`maxWidth`</Table.RowHeaderCell>
        <Table.Cell>`React.CSSProperties['maxWidth']`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Maximum width of the chatbar container</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`asChild`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`false`</Table.Cell>
        <Table.Cell>Render as a different element using Slot</Table.Cell>
      </Table.Row>
    </Table.Body>
  </Table.Root>
</Box>

</Section>

<Separator size="4"/>

<Section size="1">

## Attachment Props

<Box>
  <Table.Root mt="6" mb="6" size="2" variant="ghost">
    <Table.Header>
      <Table.Row>
        <Table.ColumnHeaderCell>Prop</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Type</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Default</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Description</Table.ColumnHeaderCell>
      </Table.Row>
    </Table.Header>
    <Table.Body>
      <Table.Row>
        <Table.RowHeaderCell>`attachments`</Table.RowHeaderCell>
        <Table.Cell>`ChatbarAttachment[]`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Controlled attachments array</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`defaultAttachments`</Table.RowHeaderCell>
        <Table.Cell>`ChatbarAttachment[]`</Table.Cell>
        <Table.Cell>`[]`</Table.Cell>
        <Table.Cell>Default attachments for uncontrolled usage</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`onAttachmentsChange`</Table.RowHeaderCell>
        <Table.Cell>`(attachments: ChatbarAttachment[]) => void`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Callback when attachments change</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`accept`</Table.RowHeaderCell>
        <Table.Cell>`string | string[]`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Accepted file types (MIME types or extensions)</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`multiple`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`true`</Table.Cell>
        <Table.Cell>Allow multiple file selection</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`maxAttachments`</Table.RowHeaderCell>
        <Table.Cell>`number`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Maximum number of attachments allowed</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`maxFileSize`</Table.RowHeaderCell>
        <Table.Cell>`number`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Maximum file size in bytes</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`paste`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`true`</Table.Cell>
        <Table.Cell>Enable paste-to-attach functionality</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`pasteAccept`</Table.RowHeaderCell>
        <Table.Cell>`string | string[]`</Table.Cell>
        <Table.Cell>`accept`</Table.Cell>
        <Table.Cell>File types accepted from paste (defaults to accept)</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`clearOnSubmit`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`true`</Table.Cell>
        <Table.Cell>Clear attachments after submission</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`onAttachmentReject`</Table.RowHeaderCell>
        <Table.Cell>`(rejections: { file: File; reason: 'type' | 'size' | 'count' }[]) => void`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Callback when files are rejected</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`dropzone`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`true`</Table.Cell>
        <Table.Cell>Enable drag-and-drop file uploads</Table.Cell>
      </Table.Row>
    </Table.Body>
  </Table.Root>
</Box>

</Section>

<Separator size="4"/>

<Section size="1">

## Subcomponents

### Chatbar.Textarea

The multi-line text input component with auto-resizing behavior.

<Box>
  <Table.Root mt="6" mb="6" size="2" variant="ghost">
    <Table.Header>
      <Table.Row>
        <Table.ColumnHeaderCell>Prop</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Type</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Default</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Description</Table.ColumnHeaderCell>
      </Table.Row>
    </Table.Header>
    <Table.Body>
      <Table.Row>
        <Table.RowHeaderCell>`submitOnEnter`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`false`</Table.Cell>
        <Table.Cell>Submit on Enter key press (Shift+Enter for newline)</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`onPaste`</Table.RowHeaderCell>
        <Table.Cell>`React.ClipboardEventHandler<HTMLTextAreaElement>`</Table.Cell>
        <Table.Cell>`undefined`</Table.Cell>
        <Table.Cell>Handler for paste events</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`asChild`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`false`</Table.Cell>
        <Table.Cell>Render as a different element using Slot</Table.Cell>
      </Table.Row>
    </Table.Body>
  </Table.Root>
</Box>

### Chatbar.AttachTrigger

Button component for opening the file picker dialog.

<Box>
  <Table.Root mt="6" mb="6" size="2" variant="ghost">
    <Table.Header>
      <Table.Row>
        <Table.ColumnHeaderCell>Prop</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Type</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Default</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Description</Table.ColumnHeaderCell>
      </Table.Row>
    </Table.Header>
    <Table.Body>
      <Table.Row>
        <Table.RowHeaderCell>`accept`</Table.RowHeaderCell>
        <Table.Cell>`string | string[]`</Table.Cell>
        <Table.Cell>`Root accept`</Table.Cell>
        <Table.Cell>Override accepted file types for this trigger</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`multiple`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`Root multiple`</Table.Cell>
        <Table.Cell>Override multiple file selection for this trigger</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`asChild`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`false`</Table.Cell>
        <Table.Cell>Render as a different element using Slot</Table.Cell>
      </Table.Row>
    </Table.Body>
  </Table.Root>
</Box>

### Chatbar.Send

Send button with conditional visibility based on sendMode.

<Box>
  <Table.Root mt="6" mb="6" size="2" variant="ghost">
    <Table.Header>
      <Table.Row>
        <Table.ColumnHeaderCell>Prop</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Type</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Default</Table.ColumnHeaderCell>
        <Table.ColumnHeaderCell>Description</Table.ColumnHeaderCell>
      </Table.Row>
    </Table.Header>
    <Table.Body>
      <Table.Row>
        <Table.RowHeaderCell>`clearOnSend`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`true`</Table.Cell>
        <Table.Cell>Clear attachments after sending</Table.Cell>
      </Table.Row>
      <Table.Row>
        <Table.RowHeaderCell>`asChild`</Table.RowHeaderCell>
        <Table.Cell>`boolean`</Table.Cell>
        <Table.Cell>`false`</Table.Cell>
        <Table.Cell>Render as a different element using Slot</Table.Cell>
      </Table.Row>
    </Table.Body>
  </Table.Root>
</Box>

</Section>

<Separator size="4"/>

<Section size="1">

## Types

### ChatbarAttachment

<CodeBlock>

```tsx
interface ChatbarAttachment {
  id: string;
  name: string;
  size: number;
  type: string;
  /** Original File object for uploads and processing */
  file: File;
  url?: string;
  status?: 'idle' | 'uploading' | 'error' | 'done';
  progress?: number;
  meta?: Record<string, unknown>;
}
```

</CodeBlock>

### ChatbarApi

Imperative API for programmatic control.

<CodeBlock>

```tsx
interface ChatbarApi {
  /** Focus the textarea input */
  focusTextarea: () => void;
  /** Open the file picker dialog (respects accept/multiple) */
  openFilePicker: () => void;
}
```

</CodeBlock>

</Section>

<Separator size="4"/>

<Section size="1">

## Accessibility

The Chatbar component provides comprehensive accessibility support:

- **ARIA attributes**: Proper `aria-expanded` on the root element
- **Keyboard navigation**: Full keyboard support for all interactions
- **Screen reader support**: Proper labeling and announcements
- **Focus management**: Logical focus flow and trap management
- **High contrast mode**: Support for Windows High Contrast mode
- **Reduced motion**: Respects `prefers-reduced-motion` user preference

### Required Accessibility Props

<Callout.Root variant="surface" size="2" color="orange" my="6" highContrast>
  <Callout.Text>Always provide an accessible name for the textarea using either `aria-label` or `aria-labelledby`.</Callout.Text>
</Callout.Root>

<CodeBlock>

```tsx
<Chatbar.Root>
  <Chatbar.Textarea 
    placeholder="Type a message..."
    aria-label="Message input"
  />
  {/* ... */}
</Chatbar.Root>
```

</CodeBlock>

</Section>

<Separator size="4"/>

<Section size="1">

## Examples

### Basic Chatbar

<CodeBlock>

```tsx
<Chatbar.Root onSubmit={({ value, attachments }) => {
  console.log('Message:', value);
  console.log('Attachments:', attachments);
}}>
  <Chatbar.Textarea 
    placeholder="Type a message..."
    aria-label="Message input"
  />
  <Chatbar.AttachTrigger />
  <Chatbar.Send />
</Chatbar.Root>
```

</CodeBlock>

### With File Restrictions

<CodeBlock>

```tsx
<Chatbar.Root 
  accept="image/*,.pdf,.doc,.docx"
  maxFileSize={5 * 1024 * 1024} // 5MB
  maxAttachments={3}
  onAttachmentReject={(rejections) => {
    console.log('Rejected files:', rejections);
  }}
  onSubmit={({ value, attachments }) => {
    // Handle submission
  }}
>
  <Chatbar.Textarea 
    placeholder="Type a message..."
    aria-label="Message input"
  />
  <Chatbar.AttachTrigger />
  <Chatbar.Send />
</Chatbar.Root>
```

</CodeBlock>

### Controlled State

<CodeBlock>

```tsx
const [value, setValue] = useState('');
const [attachments, setAttachments] = useState<ChatbarAttachment[]>([]);

<Chatbar.Root 
  value={value}
  onValueChange={setValue}
  attachments={attachments}
  onAttachmentsChange={setAttachments}
  onSubmit={({ value, attachments }) => {
    // Handle submission
    setValue('');
    setAttachments([]);
  }}
>
  <Chatbar.Textarea 
    placeholder="Type a message..."
    aria-label="Message input"
  />
  <Chatbar.AttachTrigger />
  <Chatbar.Send />
</Chatbar.Root>
```

</CodeBlock>

### With Attachments Display

<CodeBlock>

```tsx
<Chatbar.Root onSubmit={({ value, attachments }) => {
  console.log('Message:', value);
  console.log('Attachments:', attachments);
}}>
  <Chatbar.AttachmentsRow />
  <Chatbar.Textarea 
    placeholder="Type a message..."
    aria-label="Message input"
  />
  <Chatbar.AttachTrigger />
  <Chatbar.Send />
</Chatbar.Root>
```

</CodeBlock>

### Custom Layout

<CodeBlock>

```tsx
<Chatbar.Root onSubmit={({ value, attachments }) => {
  console.log('Message:', value);
  console.log('Attachments:', attachments);
}}>
  <Chatbar.InlineStart>
    <IconButton size="1" variant="ghost">
      <SmileIcon />
    </IconButton>
  </Chatbar.InlineStart>
  
  <Chatbar.Textarea 
    placeholder="Type a message..."
    aria-label="Message input"
  />
  
  <Chatbar.InlineEnd>
    <Chatbar.AttachTrigger />
    <Chatbar.Send />
  </Chatbar.InlineEnd>
</Chatbar.Root>
```

</CodeBlock>

</Section>